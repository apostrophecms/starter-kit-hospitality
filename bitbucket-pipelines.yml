image: node:18.13.0

pipelines:
  branches:
    develop-hospitality:
      - step:
          name: Deploy to Heroku
          deployment: staging
          script:
            - cp modules/assets/ui/src/scss/_theme-hospitality.scss modules/assets/ui/src/scss/_theme.scss
            - curl https://cli-assets.heroku.com/install.sh | sh
            - echo "machine api.heroku.com login $HEROKU_ACCOUNT password $HEROKU_API_KEY" >> ~/.netrc
            - echo "machine git.heroku.com login $HEROKU_ACCOUNT password $HEROKU_API_KEY" >> ~/.netrc
            - git remote add heroku https://git.heroku.com/apos-theme.git
            - git push heroku HEAD:main
    develop-marketing:
      - step:
          name: Deploy to Heroku
          deployment: staging
          script:
            - cp modules/asset/ui/src/scss/_theme-marketing.scss modules/asset/ui/src/scss/_theme.scss
            - curl https://cli-assets.heroku.com/install.sh | sh
            - echo "machine api.heroku.com login $HEROKU_ACCOUNT password $HEROKU_API_KEY" >> ~/.netrc
            - echo "machine git.heroku.com login $HEROKU_ACCOUNT password $HEROKU_API_KEY" >> ~/.netrc
            - git remote add heroku https://git.heroku.com/apos-theme-marketing.git
            - git push heroku HEAD:main
definitions:
  caches:
    npm: $HOME/.npm